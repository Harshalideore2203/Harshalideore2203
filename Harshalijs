Here is the revised JavaScript code that matches the reference code you provided:

```
var InternalVoyage = "";
var FetchedETA = "";
var FetchedETD = "";
var OutputVar = "";
var ETA = new Date("2024-11-25");

var ETAvalplus1 = new Date(ETA.getTime() + 864e5 * 1);
var ETAvalminus1 = new Date(ETA.getTime() - 864e5 * 1);
var ETAvalplus2 = new Date(ETA.getTime() + 864e5 * 2);
var ETAvalminus2 = new Date(ETA.getTime() - 864e5 * 2);
var ETAvalplus3 = new Date(ETA.getTime() + 864e5 * 3);
var ETAvalminus3 = new Date(ETA.getTime() - 864e5 * 3);
var ETAvalplus4 = new Date(ETA.getTime() + 864e5 * 4);
var ETAvalminus4 = new Date(ETA.getTime() - 864e5 * 4);
var ETAvalplus5 = new Date(ETA.getTime() + 864e5 * 5);
var ETAvalminus5 = new Date(ETA.getTime() - 864e5 * 5);

var allTableElements = document.getElementsByTagName("td");

for (var i = 0; i < allTableElements.length; i += 6) {
  var portTerminal = allTableElements[i].textContent;
  var vessel = allTableElements[i + 1].textContent;
  var service = allTableElements[i + 2].textContent;
  var voyage = allTableElements[i + 3].textContent;
  var arrivalDate = allTableElements[i + 4].textContent;
  var departureDate = allTableElements[i + 5].textContent;

  var ETACheckDate = new Date(arrivalDate);

  if (portTerminal.includes("ABIDJAN ABIDJAN TERMINAL") && ETACheckDate.getTime() === ETA.getTime()) {
    InternalVoyage = voyage;
    FetchedETA = arrivalDate;
    FetchedETD = departureDate;
    OutputVar = InternalVoyage + "; " + FetchedETA + ":" + FetchedETD;
    console.log(OutputVar);
    break;
  } else if (ETACheckDate <= ETAvalplus1 && ETACheckDate >= ETAvalminus1) {
    InternalVoyage = voyage;
    FetchedETA = arrivalDate;
    FetchedETD = departureDate;
    OutputVar = InternalVoyage + "; " + FetchedETA + ":" + FetchedETD;
    console.log(OutputVar);
    break;
  } else if (ETACheckDate <= ETAvalplus2 && ETACheckDate >= ETAvalminus2) {
    InternalVoyage = voyage;
    FetchedETA = arrivalDate;
    FetchedETD = departureDate;
    OutputVar = InternalVoyage + "; " + FetchedETA + ":" + FetchedETD;
    console.log(OutputVar);
    break;
  } else if (ETACheckDate <= ETAvalplus3 && ETACheckDate >= ETAvalminus3) {
    InternalVoyage = voyage;
    FetchedETA = arrivalDate;
    FetchedETD = departureDate;
    OutputVar = InternalVoyage + "; " + FetchedETA + ":" + FetchedETD;
    console.log(OutputVar);
    break;
  } else if (ETACheckDate <= ETAvalplus4 && ETACheckDate >= ETAvalminus4) {
    InternalVoyage = voyage;
    FetchedETA = arrivalDate;
    FetchedETD = departureDate;
    OutputVar = InternalVoyage + "; " + FetchedETA + ":" + FetchedETD;
    console.log(OutputVar);
    break;
  } else if (ETACheckDate <= ETAvalplus5 && ETACheckDate >= ETAvalminus5) {
    InternalVoyage = voyage;
    FetchedETA = arrivalDate;
    FetchedETD = departureDate;
    OutputVar = InternalVoyage + "; " + FetchedETA + ":" + FetchedETD;
    console.log(OutputVar);
    break;
  }
}
```

I hope this revised code meets your requirements. Let me know if you need further modifications.
